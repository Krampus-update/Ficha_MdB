<?xml version="1.0" encoding="UTF-8"?>
<rectangle class="fundo">
	<scrollBox align="client">
		<flowLayout class="tile" align="top" height="400" margins="{left=10, right=10, top=10}" autoHeight="true" horzAlign="center" lineSpacing="3" name="fraCaracteristicasLayout">

		<rectangle left="0" top="0" width="1205" height="105" color="black">
			<label left="3" top="1" width="100" height="20" text="DESCRIÇÃO"/>
		
			<label left="10" top="25" width="90" height="20" text="TAMANHO" horzTextAlign="center"/>
			<comboBox left="100" top="25" width="100" field="tamanho" fontColor="white" items="{'Minúsculo', 'Diminuto', 'Miúdo', 'Pequeno', 'Médio', 'Grande', 'Enorme', 'Imenso', 'Colossal'}" values="{'-4','-3','-2','-1','0','1','2','3','4'}" horzTextAlign="center"/>
			<checkBox left="200" top="25" width="100" field="quadrupede" text="Quadrúpede" />
			<Descricao left1="10" left2="100" top="50" text="ALTURA" field="altura"/>
			<Descricao left1="10" left2="100" top="75" text="PESO" field="peso"/>
			
			<Descricao left1="310" left2="400" top="25" text="IDADE" field="idade"/>
			<Descricao left1="310" left2="400" top="50" text="SEXO" field="sexo"/>
			<Descricao left1="310" left2="400" top="75" text="OUTROS" field="aparenciaOutros"/>
			
			<Descricao left1="610" left2="700" top="25" text="OLHOS" field="aparenciaOlhos"/>
			<Descricao left1="610" left2="700" top="50" text="PELE" field="pele"/>
			<Descricao left1="610" left2="700" top="75" text="CABELO" field="cabelo"/>
			
			<Descricao left1="910" left2="1000" top="25" text="PLANO" field="plano"/>
			<Descricao left1="910" left2="1000" top="50" text="REGIÃO" field="regiao"/>
			<Descricao left1="910" left2="1000" top="75" text="REINO" field="reino"/>
		</rectangle>

		<dataLink fields="{'tamanho', 'quadrupede', 'efetFor'}">
			<event name="onChange">
				<![CDATA[
				if sheet~=nil then
					local str = tonumber(sheet.efetFor) or 1;
					local size = tonumber(sheet.tamanho) or 0;
					local quad = sheet.quadrupede;
					local mult = 1;
					local mod1 = 0;
					local mod2 = 0;
					if size == -4 then
						if quad then
							mult = 1 / 4;
						else
							mult = 1 / 8;
						end;
						mod1 = 8;
						mod2 = 16;
					elseif size == -3 then
						if quad then
							mult = 1 / 2;
						else
							mult = 1 / 4;
						end;
						mod1 = 4;
						mod2 = 12;
					elseif size == -2 then
						if quad then
							mult = 3 / 4;
						else
							mult = 1 / 2;
						end;
						mod1 = 2;
						mod2 = 8;
					elseif size == -1 then
						if quad then
							mult = 1;
						else
							mult = 3 / 4;
						end;
						mod1 = 1;
						mod2 = 4;
					elseif size == 0 then
						if quad then
							mult = 1.5;
						else
							mult = 1;
						end;
					elseif size == 1 then
						if quad then
							mult = 3;
						else
							mult = 2;
						end;
						mod1 = -1;
						mod2 = -4;
					elseif size == 2 then
						if quad then
							mult = 6;
						else
							mult = 4;
						end;
						mod1 = -2;
						mod2 = -8;
					elseif size == 3 then
						if quad then
							mult = 12;
						else
							mult = 8;
						end;
						mod1 = -4;
						mod2 = -12;
					elseif size == 4 then
						if quad then
							mult = 24;
						else
							mult = 16;
						end;
						mod1 = -8;
						mod2 = -16;
					end;
					while str > 29 do
						mult = mult * 4;
						str = str - 10;
					end;
					if str < 1 then
						str = 1;
					end;
					local load = ndb.load("loads.xml");
					local light = (load.light[str] * mult);
					local medium = (load.medium[str] * mult);
					local heavy = (load.heavy[str] * mult);
					sheet.cargaLeve = light .. "Kg";
					sheet.cargaMedia = medium .. "Kg";
					sheet.cargaPesada = heavy .. "Kg";
					sheet.agarrarTam = 0 - mod2;
					sheet.tamanhoCa = mod1;
				end;
				]]>
			</event>	
		</dataLink>

			<flowLineBreak/>
			<!-- Primeira Linha -->
			<flowLayout class="oneLineTile2" autoHeight="true" minScaledWidth="290" horzAlign="center" lineSpacing="10">
				<!-- PRIMEIRA COLUNA -->
				<flowLayout maxControlsPerLine="1" autoHeight="true" class="tileCarac" lineSpacing="10" margins="{left = 4, right = 4}">

					<!-- IMAGEM -->
					<flowPart class="tileCarac" height="390" frameStyle="frames/panel5/frame.xml" margins="{left = 0, right = 4}">
						<image align="client" style="proportional" field="imagens.aparencia" class="transparente" margins="{top=2}" editable="true" animate="true"/>
						<label align="bottom" autoSize="true" text="APARÊNCIA" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
					</flowPart>

					<!-- IDIOMAS -->
					<flowPart class="tileCarac" height="115" frameStyle="frames/panel5/frame.xml" margins="{left = 4, right = 0}">
						<textEditor align="client" field="idiomas" class="transparente" margins="{top=2}" fontSize="16"/>
						<label align="bottom" autoSize="true" text="IDIOMAS" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
					</flowPart>
				</flowLayout>

				<!-- TRACOS DE PERSONALIDADE, IDEAIS, VINCULOS, FRAQUEZAS -->
				<flowLayout maxControlsPerLine="1" autoHeight="true" class="tileCarac" lineSpacing="10" margins="{left=4, right=4}">

					<!-- TRAÇOS DE PERSONALIDADE -->
					<flowPart class="tileCarac" height="140" frameStyle="frames/panel5/topPanel.xml" margins="{left = 4, right = 4}">
						<textEditor align="client" field="caracteristicas.tracosPersonalidade" class="transparente" margins="{top=2}" fontSize="16"/>
						<label align="bottom" autoSize="true" text="TRAÇOS DE PERSONALIDADE" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
					</flowPart>

					<!-- IDEAIS -->
					<flowPart class="tileCarac" height="115" frameStyle="frames/panel5/centerPanel.xml" margins="{left = 4, right = 4}">
						<textEditor align="client" field="caracteristicas.ideais" class="transparente" margins="{top=2}" fontSize="16"/>
						<label align="bottom" autoSize="true" text="IDEAIS" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
					</flowPart>

					<!-- VÍNCULOS -->
					<flowPart class="tileCarac" height="115" frameStyle="frames/panel5/centerPanel.xml" margins="{left = 4, right = 4}">
						<textEditor align="client" field="caracteristicas.vinculos" class="transparente" margins="{top=2}" fontSize="16"/>
						<label align="bottom" autoSize="true" text="VÍNCULOS" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
					</flowPart>

					<!-- FRAQUEZAS -->
					<flowPart class="tileCarac" height="115" frameStyle="frames/panel5/bottomPanel.xml" margins="{left = 4, right = 4}">
						<textEditor align="client" field="caracteristicas.fraquezas" class="transparente" margins="{top=2}" fontSize="16"/>
						<label align="bottom" autoSize="true" text="FRAQUEZAS" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
					</flowPart>
				</flowLayout>
			</flowLayout>

			<flowLineBreak/>

			<!-- TERCEIRA LINHA -->
			<flowLayout class="oneLineTile2" autoHeight="true" minScaledWidth="290" horzAlign="center" lineSpacing="10" margins="{top=5}">
			
				<!-- ALIADOS E ORGANIZAÇÕES -->
				<flowLayout name="fraAliadosOrganizacoes" class="tile" autoHeight="true" frameStyle="frames/panel5/frame.xml" margins="{left = 4, right = 4}" horzAlign="center">
					<event name="onBeforeLayoutCalc">
						<![CDATA[
								if self.fraAliadosOrganizacoes:getWidth() <= 300 then
									self.prtAliados:setHeight(100);
									self.prtFaccao:setHeight(100);
								else
									self.prtAliados:setHeight(300);
									self.prtFaccao:setHeight(300);
								end;
						]]>
					</event>

					<flowPart name="prtAliados" minWidth="250" maxWidth="2500" minScaledWidth="250" height="250" avoidScale="true">
						<textEditor align="client" field="aliados.aliadosEOrganizacoes" class="transparente" margins="{top=2, left=4, right=4}" fontSize="16"/>
					</flowPart>

					<flowPart name ="prtFaccao" class="halfTile" stepSizes="{250, 300}" maxScaledWidth="300" avoidScale="true" height="300" frameStyle="frames/panel4transp/frame.xml" margins="{left=4, right=4, bottom=4, top=4}">
						<label align="top" horzTextAlign="leading" text="FACÇÃO" fontSize="11" fontColor="gray" margins="{left=4, right=4}"/>
						<edit align="top" field="aliados.faccao.nome" margins="{left=4, right=4}"/>
						<image align="client" field="aliados.faccao.simbolo" editable="true" style="proportional" margins="{left=4, right=4}"/>
						<label align="bottom" autoSize="true" text="SÍMBOLO DA FACÇÃO" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
					</flowPart>

					<flowLineBreak/>

					<flowPart minWidth="200" maxWidth="2500" height="16">
						<label align="client" autoSize="true" text="ALIADOS E ORGANIZAÇÕES" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
					</flowPart>
				</flowLayout>

				<!-- CARACTERISTICAS E TRACOS -->
				<flowPart class="tile" height="250" frameStyle="frames/panel5/frame.xml" margins="{left = 4, right = 4}" adjustHeightToLine="true">
					<checkBox align="right" width="15" field="caracteristicas.usarEditorFancy" margins="{left = 2, right = -2}">
						<event name="onChange">
							if sheet then
								self.caracteristicasFancy:setVisible(sheet.caracteristicas.usarEditorFancy);
								self.caracteristicasMerda:setVisible(not (sheet.caracteristicas.usarEditorFancy));
							end;
						</event>
					</checkBox>
					<richEdit name="caracteristicasFancy" align="client" field="caracteristicas.texto2" class="transparente" backgroundColor="#333333" defaultFontColor="white" hideSelection="false" defaultFontSize="16" animateImages="true" margins="{top=2}" visible="false"/>
					<textEditor name="caracteristicasMerda" align="client" field="caracteristicas.caracteristicasETracoes" class="transparente" margins="{top=2}" fontSize="16" visible="true"/>
					<label align="bottom" autoSize="true" text="CARACTERÍSTICAS E TRAÇOS" fontSize="12" vertTextAlign="center" horzTextAlign="center" fontStyle="bold"/>
				</flowPart>
			</flowLayout>
		</flowLayout>
	</scrollBox>
</rectangle>
